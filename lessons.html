<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SoftFingers - Professional Typing Lessons</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="canonical" href="https://softfingers-typing.com/lessons.html">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --accent-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --success-gradient: linear-gradient(135deg, #81ffef 0%, #f067b4 100%);
      
      --bg-primary: #0f1419;
      --bg-secondary: #1a1f2e;
      --bg-card: #242b3d;
      --bg-input: #2a3441;
      
      --text-primary: #ffffff;
      --text-secondary: #b8c5d6;
      --text-muted: #8a9ab0;
      
      --border-subtle: #374151;
      --border-accent: #4f46e5;
      
      --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.1);
      --shadow-md: 0 4px 20px rgba(0, 0, 0, 0.15);
      --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.2);
      
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
    }

    /* Header Styles */
    .header {
      background: var(--primary-gradient);
      padding: 3rem 2rem;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 100" fill="white" opacity="0.1"><path d="M0,50 Q250,0 500,50 T1000,50 L1000,100 L0,100 Z"/></svg>') no-repeat bottom;
      background-size: 100% 100px;
    }

    .header-content {
      position: relative;
      z-index: 1;
    }

    .header h1 {
      font-size: 3rem;
      font-weight: 700;
      margin-bottom: 1rem;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .header .subtitle {
      font-size: 1.25rem;
      opacity: 0.9;
      font-weight: 400;
    }

    /* Container */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    /* Card Styles */
    .card {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: var(--shadow-md);
      border: 1px solid var(--border-subtle);
      transition: var(--transition);
    }

    .card:hover {
      box-shadow: var(--shadow-lg);
      transform: translateY(-2px);
    }

    /* Tab Navigation */
    .tab-navigation {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 2rem;
      background: var(--bg-secondary);
      padding: 0.5rem;
      border-radius: var(--radius-md);
    }

    .tab {
      flex: 1;
      padding: 1rem 2rem;
      text-align: center;
      background: transparent;
      border: none;
      border-radius: var(--radius-sm);
      color: var(--text-secondary);
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
    }

    .tab.active {
      background: var(--primary-gradient);
      color: var(--text-primary);
      box-shadow: var(--shadow-sm);
    }

    .tab:hover:not(.active) {
      background: var(--bg-input);
      color: var(--text-primary);
    }

    /* Progress Section */
    .progress-section {
      background: var(--bg-secondary);
      padding: 1.5rem;
      border-radius: var(--radius-md);
      margin-bottom: 2rem;
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .progress-text {
      font-weight: 600;
      color: var(--text-primary);
    }

    .progress-bar-container {
      height: 8px;
      background: var(--bg-input);
      border-radius: 4px;
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      background: var(--accent-gradient);
      transition: width 0.5s ease;
      width: 0%;
    }

    /* Lesson Area */
    .lesson-container {
      background: var(--bg-secondary);
      border-radius: var(--radius-lg);
      padding: 2rem;
      margin-bottom: 2rem;
    }

    .lesson-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
      padding-bottom: 1rem;
      border-bottom: 2px solid var(--border-subtle);
    }

    .lesson-title {
      font-size: 1.5rem;
      font-weight: 600;
    }

    .lesson-timestamp {
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    .passage {
      background: var(--bg-card);
      padding: 2rem;
      border-radius: var(--radius-md);
      font-family: 'Monaco', 'Consolas', monospace;
      font-size: 1.5rem;
      line-height: 1.8;
      margin-bottom: 1.5rem;
      border: 2px solid var(--border-subtle);
      max-height: 120px;
    }

    .typing-input {
      width: 100%;
      padding: 1.5rem;
      font-size: 1.1rem;
      background: var(--bg-input);
      border: 2px solid var(--border-subtle);
      border-radius: var(--radius-md);
      color: var(--text-primary);
      font-family: 'Monaco', 'Consolas', monospace;
      transition: var(--transition);
    }

    .typing-input:focus {
      outline: none;
      border-color: var(--border-accent);
      box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
    }

    /* Stats and Controls */
    .lesson-controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-top: 2rem;
    }

    .control-group {
      display: flex;
      gap: 0.5rem;
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: var(--radius-sm);
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .btn-primary {
      background: var(--primary-gradient);
      color: var(--text-primary);
    }

    .btn-secondary {
      background: var(--bg-input);
      color: var(--text-secondary);
      border: 1px solid var(--border-subtle);
    }

    .btn:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-sm);
    }

    .stat-card {
      background: var(--bg-input);
      padding: 1rem;
      border-radius: var(--radius-sm);
      text-align: center;
      border: 1px solid var(--border-subtle);
    }

    .stat-label {
      font-size: 0.8rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 0.5rem;
    }

    .stat-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--text-primary);
    }

    /* Keyboard Styles */
    .keyboard-section {
      margin: 3rem 0;
    }

    .keyboard-container {
      background: var(--bg-card);
      padding: 2rem;
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-subtle);
    }

    .keyboard {
      max-width: 800px;
      margin: 0 auto;
    }

    .keyboard-row {
      display: flex;
      justify-content: center;
      gap: 0.25rem;
      margin-bottom: 0.25rem;
    }

    .key {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 4px;
      padding: 0.75rem;
      min-width: 2.5rem;
      height: 2.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: inherit;
      font-size: 0.9rem;
      color: var(--text-secondary);
      transition: var(--transition);
      position: relative;
      overflow: hidden;
    }

    .key:hover {
      background: var(--bg-input);
    }

    .key.active {
      background: var(--accent-gradient);
      color: var(--text-primary);
      box-shadow: var(--shadow-sm);
    }

    .key.wide { min-width: 4rem; }
    .key.xwide { min-width: 6rem; }
    .key.xxwide { min-width: 8rem; }
    .key.space { min-width: 20rem; }

    /* Locked Content */
    .locked-section {
      background: var(--bg-secondary);
      border: 2px dashed var(--border-subtle);
      border-radius: var(--radius-lg);
      padding: 3rem;
      text-align: center;
      opacity: 0.6;
    }

    .lock-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
      opacity: 0.5;
    }

    .lock-message {
      font-size: 1.1rem;
      color: var(--text-muted);
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 1000;
    }

    .modal-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      padding: 2rem;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--text-muted);
    }

    /* Certificate Link */
    .certificate-section {
      text-align: center;
      margin: 3rem 0;
    }

    .cert-btn {
      background: var(--success-gradient);
      color: var(--text-primary);
      padding: 1rem 2rem;
      border-radius: var(--radius-md);
      text-decoration: none;
      font-weight: 600;
      font-size: 1.1rem;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      transition: var(--transition);
    }

    .cert-btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .header {
        padding: 2rem 1rem;
      }
      
      .header h1 {
        font-size: 2rem;
      }
      
      .container {
        padding: 1rem;
      }
      
      .card {
        padding: 1.5rem;
      }
      
      .tab-navigation {
        flex-direction: column;
      }
      
      .lesson-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;
      }
      
      .lesson-controls {
        grid-template-columns: 1fr;
      }
      
      .key.space {
        min-width: 10rem;
      }
    }

    /* Animation Classes */
    .fade-in {
      opacity: 0;
      animation: fadeIn 0.5s ease forwards;
    }

    @keyframes fadeIn {
      to { opacity: 1; }
    }

    .slide-up {
      transform: translateY(20px);
      opacity: 0;
      animation: slideUp 0.5s ease forwards;
    }

    @keyframes slideUp {
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    /* Hidden class */
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <div class="header">
    <div class="header-content">
      <h1>Professional Typing Lessons</h1>
      <div class="subtitle">Master touch typing with our comprehensive training program 🚀</div>
    </div>
  </div>

  <div class="container">
    <!-- Tab Navigation -->
    <div class="tab-navigation" id="lesson-tabs">
      <button class="tab active" data-level="beginner">Beginner</button>
      <button class="tab" data-level="intermediate">Intermediate</button>
      <button class="tab" data-level="advanced">Advanced</button>
    </div>

    <!-- Beginner Section -->
    <div class="section fade-in" id="section-beginner">
      <!-- Progress Section -->
      <div class="progress-section">
        <div class="progress-header">
          <span class="progress-text" id="progress-text">Progress: 0 / 120 lessons passed</span>
          <button class="btn btn-secondary" id="progress-btn">📊 View History</button>
        </div>
        <div class="progress-bar-container">
          <div class="progress-bar" id="progress-bar"></div>
        </div>
      </div>

      <!-- Introduction Card -->
      <div class="card slide-up">
        <h2>Introduction to Touch Typing</h2>
        <p style="margin-bottom: 2rem; font-size: 1.1rem; color: var(--text-secondary);">
          <strong>Touch Typing</strong> is the ability to type without looking at the keyboard. This skill significantly improves your typing speed, accuracy, and reduces physical strain during extended typing sessions.
        </p>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin-bottom: 2rem;">
          <div>
            <h3 style="margin-bottom: 1rem; color: var(--text-primary);">Proper Sitting Position</h3>
            <ul style="color: var(--text-secondary); line-height: 1.8;">
              <li>Sit upright with your back straight and shoulders relaxed</li>
              <li>Keep feet flat on the floor with monitor at eye level</li>
              <li>Maintain slightly raised wrists without resting them on the keyboard</li>
              <li>Keep forearms parallel to the floor and take regular breaks</li>
            </ul>
          </div>
          <div>
            <h3 style="margin-bottom: 1rem; color: var(--text-primary);">Hand Positioning</h3>
            <p style="color: var(--text-secondary); line-height: 1.8;">
              Position your hands on the <strong>Home Row</strong>: <strong>A S D F</strong> (left hand) and <strong>J K L ;</strong> (right hand). 
              Keep your thumbs on the <strong>Space</strong> bar and always return to the home row position after pressing each key.
            </p>
          </div>
        </div>

        <div style="background: var(--bg-secondary); padding: 1.5rem; border-radius: var(--radius-md);">
          <h3 style="margin-bottom: 1rem; color: var(--text-primary);">Understanding Typing Metrics</h3>
          <p style="color: var(--text-secondary); line-height: 1.8;">
            <strong>WPM (Words Per Minute)</strong>: Standard measurement where 1 word equals approximately 5 characters.<br>
            <strong>Accuracy</strong>: Percentage of correctly typed characters out of total characters typed.<br>
            <strong>AWPM (Adjusted WPM)</strong>: WPM multiplied by accuracy percentage for a more realistic speed measurement.
          </p>
        </div>
      </div>

      <!-- Lesson Requirements -->
      <div class="card slide-up">
        <h2>Lesson Requirements</h2>
        <div style="background: #8d52d1; color: white; padding: 1.5rem; border-radius: var(--radius-md); text-align: center; font-weight: 600;">
          Pass Requirement: ≥ 30 WPM and ≥ 90% Accuracy | Each lesson duration: 120 seconds
        </div>
      </div>

      <!-- Active Lesson Area -->
      <div class="lesson-container slide-up">
        <div class="lesson-header" id="lesson-header">
          <div>
            <h2 class="lesson-title" id="lesson-title">Select a lesson to begin</h2>
            <div class="lesson-timestamp" id="lesson-timestamp"></div>
          </div>
        </div>

        <div class="passage" id="passage">
          Welcome to SoftFingers Professional Typing Lessons. Select a lesson from the grid below to start your typing journey.
        </div>

        <input 
          id="typing-input" 
          type="text" 
          class="typing-input" 
          placeholder="Start typing here when lesson begins…" 
          autocomplete="off" 
          spellcheck="false"
        />

        <div class="lesson-controls">
          <div class="control-group">
            <button class="btn btn-secondary" id="prev-btn">← Previous</button>
            <button class="btn btn-secondary" id="next-btn">Next →</button>
            <button class="btn btn-primary" id="retry-btn">🔄 Retry</button>
          </div>

          <div class="stat-card">
            <div class="stat-label">Timer</div>
            <div class="stat-value" id="timer">120s</div>
          </div>

          <div class="stat-card">
            <div class="stat-label">WPM</div>
            <div class="stat-value" id="stat-wpm">0</div>
          </div>

          <div class="stat-card">
            <div class="stat-label">Accuracy</div>
            <div class="stat-value" id="stat-acc">100%</div>
          </div>
        </div>
      </div>

      <!-- Virtual Keyboard -->
      <div class="keyboard-section slide-up">
        <div class="card">
          <h2 style="text-align: center; margin-bottom: 2rem;">Live Keyboard Guide</h2>
          <div class="keyboard-container">
            <div class="keyboard">
              <!-- Row 1 -->
              <div class="keyboard-row">
                <div class="key wide" data-code="Backquote">` ~</div>
                <div class="key" data-code="Digit1">1 !</div>
                <div class="key" data-code="Digit2">2 @</div>
                <div class="key" data-code="Digit3">3 #</div>
                <div class="key" data-code="Digit4">4 $</div>
                <div class="key" data-code="Digit5">5 %</div>
                <div class="key" data-code="Digit6">6 ^</div>
                <div class="key" data-code="Digit7">7 &</div>
                <div class="key" data-code="Digit8">8 *</div>
                <div class="key" data-code="Digit9">9 (</div>
                <div class="key" data-code="Digit0">0 )</div>
                <div class="key" data-code="Minus">- _</div>
                <div class="key" data-code="Equal">= +</div>
                <div class="key xwide" data-code="Backspace">Backspace</div>
              </div>
              
              <!-- Row 2 -->
              <div class="keyboard-row">
                <div class="key wide" data-code="Tab">Tab</div>
                <div class="key" data-code="KeyQ">Q</div>
                <div class="key" data-code="KeyW">W</div>
                <div class="key" data-code="KeyE">E</div>
                <div class="key" data-code="KeyR">R</div>
                <div class="key" data-code="KeyT">T</div>
                <div class="key" data-code="KeyY">Y</div>
                <div class="key" data-code="KeyU">U</div>
                <div class="key" data-code="KeyI">I</div>
                <div class="key" data-code="KeyO">O</div>
                <div class="key" data-code="KeyP">P</div>
                <div class="key" data-code="BracketLeft">[ {</div>
                <div class="key" data-code="BracketRight">] }</div>
                <div class="key" data-code="Backslash">\ |</div>
              </div>
              
              <!-- Row 3 -->
              <div class="keyboard-row">
                <div class="key wide" data-code="CapsLock">Caps Lock</div>
                <div class="key" data-code="KeyA">A</div>
                <div class="key" data-code="KeyS">S</div>
                <div class="key" data-code="KeyD">D</div>
                <div class="key" data-code="KeyF">F</div>
                <div class="key" data-code="KeyG">G</div>
                <div class="key" data-code="KeyH">H</div>
                <div class="key" data-code="KeyJ">J</div>
                <div class="key" data-code="KeyK">K</div>
                <div class="key" data-code="KeyL">L</div>
                <div class="key" data-code="Semicolon">; :</div>
                <div class="key" data-code="Quote">' "</div>
                <div class="key xwide" data-code="Enter">Enter</div>
              </div>
              
              <!-- Row 4 -->
              <div class="keyboard-row">
                <div class="key xxwide" data-code="ShiftLeft">Shift</div>
                <div class="key" data-code="KeyZ">Z</div>
                <div class="key" data-code="KeyX">X</div>
                <div class="key" data-code="KeyC">C</div>
                <div class="key" data-code="KeyV">V</div>
                <div class="key" data-code="KeyB">B</div>
                <div class="key" data-code="KeyN">N</div>
                <div class="key" data-code="KeyM">M</div>
                <div class="key" data-code="Comma">, <</div>
                <div class="key" data-code="Period">. ></div>
                <div class="key" data-code="Slash">/ ?</div>
                <div class="key xxwide" data-code="ShiftRight">Shift</div>
              </div>
              
              <!-- Row 5 -->
              <div class="keyboard-row">
                <div class="key wide" data-code="ControlLeft">Ctrl</div>
                <div class="key wide" data-code="MetaLeft">Win</div>
                <div class="key wide" data-code="AltLeft">Alt</div>
                <div class="key space" data-code="Space">Space</div>
                <div class="key wide" data-code="AltRight">Alt</div>
                <div class="key wide" data-code="MetaRight">Win</div>
                <div class="key wide" data-code="ContextMenu">Menu</div>
                <div class="key wide" data-code="ControlRight">Ctrl</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Lessons Grid Placeholder -->
      <div class="card slide-up">
        <h2>Lesson Selection</h2>
        <div id="lessons-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
          <!-- Lessons will be populated by JavaScript -->
          <div class="stat-card" style="cursor: pointer;">
            <div class="stat-label">Lesson 1</div>
            <div class="stat-value" style="font-size: 1rem;">Home Row Keys</div>
          </div>
          <div class="stat-card" style="cursor: pointer;">
            <div class="stat-label">Lesson 2</div>
            <div class="stat-value" style="font-size: 1rem;">Basic Words</div>
          </div>
          <div class="stat-card" style="cursor: pointer;">
            <div class="stat-label">Lesson 3</div>
            <div class="stat-value" style="font-size: 1rem;">Numbers & Symbols</div>
          </div>
          <!-- More lessons would be added here -->
        </div>
      </div>

      <!-- Certificate Section -->
      <div class="certificate-section">
        <a href="certificate.html" class="cert-btn">
          🎓 View Beginner Certificate
        </a>
      </div>
    </div>

    <!-- Intermediate Section -->
    <div class="section hidden" id="section-intermediate">
      <div class="locked-section">
        <div class="lock-icon">🔒</div>
        <h2>Intermediate Lessons</h2>
        <p class="lock-message">
          Complete all Beginner lessons with ≥ 30 WPM & ≥ 90% accuracy to unlock Intermediate level.
        </p>
      </div>
    </div>

    <!-- Advanced Section -->
    <div class="section hidden" id="section-advanced">
      <div class="locked-section">
        <div class="lock-icon">🔒</div>
        <h2>Advanced Lessons</h2>
        <p class="lock-message">
          Complete all Intermediate lessons to unlock Advanced level training.
        </p>
      </div>
    </div>

    <!-- Back Button -->
    <div class="card">
      <button class="btn btn-secondary" onclick="window.location.href='main.html'">
        ← Back to Dashboard
      </button>
    </div>
  </div>

  <!-- Progress Modal -->
  <div id="progress-modal" class="modal">
    <div class="modal-content">
      <span class="close" id="close-progress">&times;</span>
      <h2>📊 Progress History</h2>
      <div class="progress-bar-container" style="margin: 1rem 0;">
        <div class="progress-bar" style="width: 25%;"></div>
      </div>
      <p id="progress-details">Track your learning progress and see detailed statistics for each completed lesson.</p>
      <div id="progress-list">
        <!-- Progress history will be populated here -->
      </div>
    </div>
  </div>

  <script>
    // Tab switching functionality
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        // Remove active class from all tabs
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        // Add active class to clicked tab
        tab.classList.add('active');
        
        // Hide all sections
        document.querySelectorAll('.section').forEach(section => {
          section.classList.add('hidden');
        });
        
        // Show selected section
        const level = tab.getAttribute('data-level');
        document.getElementById(`section-${level}`).classList.remove('hidden');
      });
    });

    // Progress modal functionality
    const progressBtn = document.getElementById('progress-btn');
    const progressModal = document.getElementById('progress-modal');
    const closeProgress = document.getElementById('close-progress');

    progressBtn.addEventListener('click', () => {
      progressModal.style.display = 'block';
    });

    closeProgress.addEventListener('click', () => {
      progressModal.style.display = 'none';
    });

    window.addEventListener('click', (e) => {
      if (e.target === progressModal) {
        progressModal.style.display = 'none';
      }
    });

    // Keyboard highlighting functionality
    const keys = document.querySelectorAll('.key');
    
    // Simulate key highlighting for demonstration
    function highlightKey(keyCode) {
      keys.forEach(key => key.classList.remove('active'));
      const targetKey = document.querySelector(`[data-code="${keyCode}"]`);
      if (targetKey) {
        targetKey.classList.add('active');
        setTimeout(() => targetKey.classList.remove('active'), 500);
      }
    }

    // Typing input functionality
    const typingInput = document.getElementById('typing-input');
    const passage = document.getElementById('passage');
    
    typingInput.addEventListener('keydown', (e) => {
      highlightKey(e.code);
    });

    // Lesson navigation
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const retryBtn = document.getElementById('retry-btn');
    
    prevBtn.addEventListener('click', () => {
      console.log('Previous lesson');
      // Add previous lesson logic
    });
    
    nextBtn.addEventListener('click', () => {
      console.log('Next lesson');
      // Add next lesson logic
    });
    
    retryBtn.addEventListener('click', () => {
      typingInput.value = '';
      document.getElementById('timer').textContent = '120s';
      document.getElementById('stat-wpm').textContent = '0';
      document.getElementById('stat-acc').textContent = '100%';
    });

    // Sample lesson data
    const lessons = [
      { id: 1, name: 'Home Row Keys', text: 'asdf jkl; asdf jkl; home row practice' },
      { id: 2, name: 'Basic Words', text: 'the quick brown fox jumps over lazy dog' },
      { id: 3, name: 'Numbers', text: '1234567890 practice typing numbers quickly' },
      { id: 4, name: 'Punctuation', text: 'Hello, world! How are you today? Fine, thanks.' },
      { id: 5, name: 'Mixed Practice', text: 'Typing 123 words per minute requires practice!' }
    ];

    // Populate lessons grid
    const lessonsGrid = document.getElementById('lessons-grid');
    lessons.forEach((lesson, index) => {
      const lessonCard = document.createElement('div');
      lessonCard.className = 'stat-card';
      lessonCard.style.cursor = 'pointer';
      lessonCard.innerHTML = `
        <div class="stat-label">Lesson ${lesson.id}</div>
        <div class="stat-value" style="font-size: 1rem;">${lesson.name}</div>
      `;
      
      lessonCard.addEventListener('click', () => {
        document.getElementById('lesson-title').textContent = `Lesson ${lesson.id}: ${lesson.name}`;
        document.getElementById('lesson-timestamp').textContent = new Date().toLocaleTimeString();
        document.getElementById('passage').textContent = lesson.text;
        typingInput.focus();
      });
      
      lessonsGrid.appendChild(lessonCard);
    });

    // Timer functionality
    let timeLeft = 120;
    let timerInterval;
    let isTyping = false;

    function startTimer() {
      if (!isTyping) {
        isTyping = true;
        timerInterval = setInterval(() => {
          timeLeft--;
          document.getElementById('timer').textContent = timeLeft + 's';
          
          if (timeLeft <= 0) {
            clearInterval(timerInterval);
            typingInput.disabled = true;
            alert('Time\'s up! Check your results.');
          }
        }, 1000);
      }
    }

    typingInput.addEventListener('input', () => {
      startTimer();
      updateStats();
    });

    // Calculate and update stats
    function updateStats() {
      const typed = typingInput.value;
      const target = passage.textContent;
      
      if (typed.length === 0) return;
      
      // Calculate accuracy
      let correct = 0;
      for (let i = 0; i < typed.length; i++) {
        if (typed[i] === target[i]) correct++;
      }
      
      const accuracy = Math.round((correct / typed.length) * 100);
      document.getElementById('stat-acc').textContent = accuracy + '%';
      
      // Calculate WPM
      const wordsTyped = typed.length / 5;
      const timeElapsed = (120 - timeLeft) / 60;
      const wpm = timeElapsed > 0 ? Math.round(wordsTyped / timeElapsed) : 0;
      document.getElementById('stat-wpm').textContent = wpm;
      
      // Update progress bar (mock calculation)
      const progress = Math.min((typed.length / target.length) * 100, 100);
      document.getElementById('progress-bar').style.width = progress + '%';
    }

    // Initialize animations
    setTimeout(() => {
      document.querySelectorAll('.slide-up').forEach((el, index) => {
        setTimeout(() => el.style.animation = 'slideUp 0.5s ease forwards', index * 100);
      });
    }, 100);

    // Responsive keyboard handling
    function adjustKeyboardForMobile() {
      if (window.innerWidth < 768) {
        document.querySelectorAll('.key.space').forEach(key => {
          key.style.minWidth = '10rem';
        });
      }
    }

    window.addEventListener('resize', adjustKeyboardForMobile);
    adjustKeyboardForMobile();

    // Enhanced typing functionality with character-by-character tracking
    let currentLesson = 0;
    let startTime = null;
    let errors = 0;
    let totalTyped = 0;
    let lessonCompleted = false;

    // Enhanced lesson data with comprehensive keyboard coverage
    const enhancedLessons = [
      // Home Row Lessons (1-4)
      {
        id: 1,
        name: 'Home Row Basics',
        text: 'asdf jkl; asdf jkl; sad jak fall jak sad fall ask dad asks lads fads jade jaded',
        category: 'home-row',
        target_wpm: 25,
        description: 'Master the home row keys A S D F J K L ;'
      },
      {
        id: 2,
        name: 'Home Row Words',
        text: 'ask sad fall dad lads fads jade hash dash flask glass flash shall slash;',
        category: 'home-row',
        target_wpm: 28,
        description: 'Form words using only home row keys'
      },
      {
        id: 3,
        name: 'Home Row Sentences',
        text: 'Dad asks a sad lad; A lass had a flask; Lads dash; A dad has a glass.',
        category: 'home-row',
        target_wpm: 30,
        description: 'Complete sentences with home row mastery'
      },
      {
        id: 4,
        name: 'Home Row Challenge',
        text: 'Flask glass slash dash; Lads ask dad; A sad lass had a jade glass; Dad shall dash.',
        category: 'home-row',
        target_wpm: 32,
        description: 'Advanced home row typing fluency'
      },
      
      // Upper Row Lessons (5-8)
      {
        id: 5,
        name: 'Upper Row Introduction',
        text: 'qwer tyui op qwer tyui op quite write route tire your quit port topic',
        category: 'upper-row',
        target_wpm: 26,
        description: 'Learn upper row keys Q W E R T Y U I O P'
      },
      {
        id: 6,
        name: 'Upper Row Words',
        text: 'quit write route tire your port topic quite power tower outer paper writer',
        category: 'upper-row',
        target_wpm: 30,
        description: 'Practice words using upper row keys'
      },
      {
        id: 7,
        name: 'Upper Row Sentences',
        text: 'Your writer quit; The tower has power; Route to the port; Write a proper topic.',
        category: 'upper-row',
        target_wpm: 34,
        description: 'Form sentences with upper row mastery'
      },
      {
        id: 8,
        name: 'Upper Row Challenge',
        text: 'Quite proper writers route power to your port; Outer tower paper topic quality.',
        category: 'upper-row',
        target_wpm: 36,
        description: 'Advanced upper row combinations'
      },
      
      // Bottom Row Lessons (9-12)
      {
        id: 9,
        name: 'Bottom Row Introduction',
        text: 'zxcv bnm, zxcv bnm, zone exam cave been name come move buzz maximum',
        category: 'bottom-row',
        target_wpm: 24,
        description: 'Learn bottom row keys Z X C V B N M , .'
      },
      {
        id: 10,
        name: 'Bottom Row Words',
        text: 'zone exam cave been name come move buzz maximum become bronze comma',
        category: 'bottom-row',
        target_wpm: 28,
        description: 'Practice words using bottom row keys'
      },
      {
        id: 11,
        name: 'Bottom Row Sentences',
        text: 'Come to the zone; Maximum buzz, become bronze; Move the cave exam.',
        category: 'bottom-row',
        target_wpm: 32,
        description: 'Form sentences with bottom row mastery'
      },
      {
        id: 12,
        name: 'Bottom Row Challenge',
        text: 'Maximum bronze buzz, zone exam become; Move comma, cave name buzz maximum.',
        category: 'bottom-row',
        target_wpm: 34,
        description: 'Advanced bottom row combinations'
      },
      
      // All Rows Combined (13-16)
      {
        id: 13,
        name: 'Two Row Combination',
        text: 'Ask the writer; Your dad has been quite sad; The tower cave move zone.',
        category: 'combined',
        target_wpm: 35,
        description: 'Combine home row with upper and bottom rows'
      },
      {
        id: 14,
        name: 'Three Row Mastery',
        text: 'Quite the maximum power; Your bronze zone writer; Cave tower exam route.',
        category: 'combined',
        target_wpm: 38,
        description: 'Master all three keyboard rows together'
      },
      {
        id: 15,
        name: 'Common Words',
        text: 'the and for are but not you all can had her was one our out day get has him his how',
        category: 'words',
        target_wpm: 40,
        description: 'Practice most common English words'
      },
      {
        id: 16,
        name: 'Quick Phrases',
        text: 'the quick brown fox jumps over the lazy dog pack my box with five dozen liquor jugs',
        category: 'phrases',
        target_wpm: 42,
        description: 'Type complete sentences with proper spacing'
      },
      
      // Numbers and Punctuation (17-20)
      {
        id: 17,
        name: 'Numbers Practice',
        text: '1234567890 one two three four five six seven eight nine zero 12 34 56 78 90 123 456',
        category: 'numbers',
        target_wpm: 30,
        description: 'Learn to type numbers efficiently'
      },
      {
        id: 18,
        name: 'Basic Punctuation',
        text: 'Hello, world! How are you today? I am fine, thank you. What time is it? It is 3:30 PM.',
        category: 'punctuation',
        target_wpm: 35,
        description: 'Master basic punctuation marks'
      },
      {
        id: 19,
        name: 'Advanced Punctuation',
        text: 'The "quick" brown fox: jumped 50% higher! Cost was $25.99 (tax included); amazing!',
        category: 'punctuation',
        target_wpm: 38,
        description: 'Practice advanced punctuation and symbols'
      },
      {
        id: 20,
        name: 'Final Challenge',
        text: 'Typing at 50+ WPM requires consistent daily practice. Focus on accuracy first, then speed will follow naturally.',
        category: 'mixed',
        target_wpm: 45,
        description: 'Ultimate typing speed and accuracy test'
      }
    ];

    // Progress tracking system
    let progressData = JSON.parse(localStorage.getItem('typingProgress')) || {
      completedLessons: [],
      bestScores: {},
      totalTime: 0,
      streak: 0
    };

    // Update lessons grid with enhanced data and categorization
    function populateLessonsGrid() {
      lessonsGrid.innerHTML = '';
      
      // Create category sections
      const categories = {
        'home-row': { name: 'Home Row Mastery', lessons: [] },
        'upper-row': { name: 'Upper Row Training', lessons: [] },
        'bottom-row': { name: 'Bottom Row Practice', lessons: [] },
        'combined': { name: 'Multi-Row Combinations', lessons: [] },
        'words': { name: 'Common Words', lessons: [] },
        'phrases': { name: 'Sentence Practice', lessons: [] },
        'numbers': { name: 'Numbers & Digits', lessons: [] },
        'punctuation': { name: 'Punctuation & Symbols', lessons: [] },
        'mixed': { name: 'Advanced Challenges', lessons: [] }
      };
      
      // Group lessons by category
      enhancedLessons.forEach(lesson => {
        if (categories[lesson.category]) {
          categories[lesson.category].lessons.push(lesson);
        }
      });
      
      // Create HTML for each category
      Object.keys(categories).forEach(categoryKey => {
        const category = categories[categoryKey];
        if (category.lessons.length === 0) return;
        
        // Create category header
        const categoryHeader = document.createElement('div');
        categoryHeader.style.cssText = `
          grid-column: 1 / -1;
          margin: 2rem 0 1rem 0;
          padding: 1rem;
          background: var(--primary-gradient);
          border-radius: var(--radius-md);
          text-align: center;
          font-weight: 600;
          font-size: 1.1rem;
        `;
        categoryHeader.innerHTML = `
          <div>${category.name}</div>
          <div style="font-size: 0.8rem; opacity: 0.9; margin-top: 0.5rem;">
            ${category.lessons.length} lesson${category.lessons.length > 1 ? 's' : ''}
          </div>
        `;
        lessonsGrid.appendChild(categoryHeader);
        
        // Add lessons for this category
        category.lessons.forEach((lesson, index) => {
          const lessonCard = document.createElement('div');
          const isCompleted = progressData.completedLessons.includes(lesson.id);
          const bestScore = progressData.bestScores[lesson.id];
          
          // Determine if lesson is locked (for progressive learning)
          const isLocked = lesson.id > 1 && !progressData.completedLessons.includes(lesson.id - 1);
          
          lessonCard.className = `stat-card ${isCompleted ? 'completed' : ''} ${isLocked ? 'locked' : ''}`;
          lessonCard.style.cursor = isLocked ? 'not-allowed' : 'pointer';
          lessonCard.style.opacity = isLocked ? '0.5' : '1';
          
          // Add category color coding
          const categoryColors = {
            'home-row': '#4ade80',
            'upper-row': '#3b82f6', 
            'bottom-row': '#f59e0b',
            'combined': '#8b5cf6',
            'words': '#ec4899',
            'phrases': '#06b6d4',
            'numbers': '#ef4444',
            'punctuation': '#10b981',
            'mixed': '#f97316'
          };
          
          lessonCard.innerHTML = `
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
              <div class="stat-label">Lesson ${lesson.id}</div>
              <div style="width: 12px; height: 12px; border-radius: 50%; background: ${categoryColors[lesson.category] || '#6b7280'};"></div>
            </div>
            <div class="stat-value" style="font-size: 0.9rem; margin-bottom: 0.5rem;">
              ${lesson.name}
              ${isLocked ? ' 🔒' : ''}
            </div>
            <div style="font-size: 0.7rem; color: var(--text-muted); line-height: 1.4;">
              ${lesson.description}
            </div>
            <div style="font-size: 0.7rem; color: var(--text-secondary); margin-top: 0.5rem;">
              Target: ${lesson.target_wpm} WPM
            </div>
            ${bestScore ? `
              <div style="font-size: 0.7rem; color: ${categoryColors[lesson.category]}; margin-top: 0.5rem;">
                ${bestScore.starRating ? generateStarDisplay(bestScore.starRating) : '⭐'} Best: ${bestScore.wpm} WPM (${bestScore.accuracy}%)
              </div>
            ` : ''}
            ${isCompleted ? `
              <div style="font-size: 0.8rem; color: #4ade80; margin-top: 0.5rem;">
                ✓ Completed
              </div>
            ` : isLocked ? `
              <div style="font-size: 0.7rem; color: #ef4444; margin-top: 0.5rem;">
                Complete Lesson ${lesson.id - 1} to unlock
              </div>
            ` : ''}
          `;
          
          lessonCard.addEventListener('click', () => {
            if (!isLocked) {
              loadLesson(enhancedLessons.findIndex(l => l.id === lesson.id));
            } else {
              alert(`Please complete Lesson ${lesson.id - 1} first to unlock this lesson.`);
            }
          });
          
          lessonsGrid.appendChild(lessonCard);
        });
      });
      
      // Update grid layout to accommodate categories
      lessonsGrid.style.display = 'grid';
      lessonsGrid.style.gridTemplateColumns = 'repeat(auto-fill, minmax(250px, 1fr))';
      lessonsGrid.style.gap = '1rem';
      lessonsGrid.style.marginTop = '1rem';
    }

    // Load specific lesson
    function loadLesson(index) {
      currentLesson = index;
      const lesson = enhancedLessons[index];
      
      document.getElementById('lesson-title').textContent = `Lesson ${lesson.id}: ${lesson.name}`;
      document.getElementById('lesson-timestamp').textContent = `Target: ${lesson.target_wpm} WPM | ${new Date().toLocaleTimeString()}`;
      document.getElementById('passage').textContent = lesson.text;
      
      resetLesson();
      highlightCurrentCharacter();
      typingInput.focus();
    }

    // Reset lesson state
    function resetLesson() {
      typingInput.value = '';
      typingInput.disabled = false;
      timeLeft = 120;
      startTime = null;
      errors = 0;
      totalTyped = 0;
      lessonCompleted = false;
      isTyping = false;
      
      document.getElementById('timer').textContent = '120s';
      document.getElementById('stat-wpm').textContent = '0';
      document.getElementById('stat-acc').textContent = '100%';
      
      clearInterval(timerInterval);
    }

    // Enhanced character highlighting
    function highlightCurrentCharacter() {
      const typed = typingInput.value;
      const target = document.getElementById('passage').textContent;
      let html = '';
      
      for (let i = 0; i < target.length; i++) {
        if (i < typed.length) {
          if (typed[i] === target[i]) {
            html += `<span style="background-color: #4ade80; color: #000;">${target[i]}</span>`;
          } else {
            html += `<span style="background-color: #ef4444; color: #fff;">${target[i]}</span>`;
          }
        } else if (i === typed.length) {
          html += `<span style="background-color: #3b82f6; color: #fff; animation: pulse 1s infinite;">${target[i]}</span>`;
        } else {
          html += target[i];
        }
      }
      
      document.getElementById('passage').innerHTML = html;
    }

    // Enhanced typing input handler with auto-focus maintenance
    typingInput.addEventListener('input', function() {
      if (!startTime) {
        startTime = new Date();
        startTimer();
      }
      
      totalTyped++;
      highlightCurrentCharacter();
      updateStats();
      
      // Check if lesson is completed
      const target = enhancedLessons[currentLesson].text;
      if (typingInput.value === target) {
        completeLesson();
      }
    });

    // Maintain focus on typing input
    typingInput.addEventListener('blur', function() {
      // Re-focus after a short delay to prevent interference with other interactions
      setTimeout(() => {
        if (!lessonCompleted && !typingInput.disabled) {
          typingInput.focus();
        }
      }, 100);
    });

    // Prevent pasting
    typingInput.addEventListener('paste', function(e) {
      e.preventDefault();
      alert('Pasting is not allowed. Please type the text manually.');
    });

    // Enhanced stats calculation
    function updateStats() {
      const typed = typingInput.value;
      const target = enhancedLessons[currentLesson].text;
      
      if (typed.length === 0) return;
      
      // Calculate accuracy
      let correct = 0;
      let currentErrors = 0;
      
      for (let i = 0; i < typed.length; i++) {
        if (typed[i] === target[i]) {
          correct++;
        } else {
          currentErrors++;
        }
      }
      
      const accuracy = Math.round((correct / typed.length) * 100);
      document.getElementById('stat-acc').textContent = accuracy + '%';
      
      // Calculate WPM
      if (startTime) {
        const timeElapsed = (new Date() - startTime) / 1000 / 60; // minutes
        const wordsTyped = correct / 5; // 5 characters = 1 word
        const wpm = timeElapsed > 0 ? Math.round(wordsTyped / timeElapsed) : 0;
        document.getElementById('stat-wpm').textContent = wpm;
      }
      
      // Update progress bar
      const progress = Math.min((typed.length / target.length) * 100, 100);
      document.getElementById('progress-bar').style.width = progress + '%';
    }

    // Complete lesson
    function completeLesson() {
      lessonCompleted = true;
      clearInterval(timerInterval);
      typingInput.disabled = true;
      
      const timeElapsed = (new Date() - startTime) / 1000;
      const wpm = Math.round((typingInput.value.length / 5) / (timeElapsed / 60));
      const accuracy = Math.round((typingInput.value.length - errors) / typingInput.value.length * 100);
      
      // Check if passed
      const lesson = enhancedLessons[currentLesson];
      const passed = wpm >= 30 && accuracy >= 90;
      
      setTimeout(() => {
        showLessonResults(wpm, accuracy, passed, timeElapsed);
        if (passed) {
          saveProgress(lesson.id, wpm, accuracy, timeElapsed);
        }
      }, 500);
    }

    // Show lesson results
    function showLessonResults(wpm, accuracy, passed, time) {
      const message = passed 
        ? `🎉 Congratulations! You passed!\n\nWPM: ${wpm}\nAccuracy: ${accuracy}%\nTime: ${Math.round(time)}s\n\nReady for the next lesson!`
        : `📚 Keep practicing!\n\nWPM: ${wpm} (need ≥30)\nAccuracy: ${accuracy}% (need ≥90%)\nTime: ${Math.round(time)}s\n\nTry again to improve your score!`;
      
      alert(message);
    }

    // Save progress
    function saveProgress(lessonId, wpm, accuracy, time) {
      if (!progressData.completedLessons.includes(lessonId)) {
        progressData.completedLessons.push(lessonId);
      }
      
      if (!progressData.bestScores[lessonId] || wpm > progressData.bestScores[lessonId].wpm) {
        progressData.bestScores[lessonId] = { wpm, accuracy, time };
      }
      
      progressData.totalTime += time;
      progressData.streak++;
      
      localStorage.setItem('typingProgress', JSON.stringify(progressData));
      updateProgressDisplay();
      populateLessonsGrid();
      
      // Check if intermediate should be unlocked
      if (progressData.completedLessons.length >= enhancedLessons.length) {
        unlockIntermediate();
      }
    }

    // Update progress display
    function updateProgressDisplay() {
      const completed = progressData.completedLessons.length;
      const total = enhancedLessons.length;
      const percentage = (completed / total) * 100;
      
      document.getElementById('progress-text').textContent = 
        `Progress: ${completed} / ${total} lessons passed (${Math.round(percentage)}%)`;
      document.getElementById('progress-bar').style.width = percentage + '%';
    }

    // Enhanced lesson navigation with auto-focus
    prevBtn.addEventListener('click', () => {
      if (currentLesson > 0) {
        loadLesson(currentLesson - 1);
      }
    });
    
    nextBtn.addEventListener('click', () => {
      if (currentLesson < enhancedLessons.length - 1) {
        const nextLesson = enhancedLessons[currentLesson + 1];
        const isNextLocked = nextLesson.id > 1 && !progressData.completedLessons.includes(nextLesson.id - 1);
        
        if (!isNextLocked) {
          loadLesson(currentLesson + 1);
        } else {
          alert(`Please complete Lesson ${nextLesson.id - 1} first to unlock this lesson.`);
        }
      }
    });
    
    retryBtn.addEventListener('click', () => {
      resetLesson();
      highlightCurrentCharacter();
    });

    // Unlock intermediate level
    function unlockIntermediate() {
      const intermediateSection = document.getElementById('section-intermediate');
      const lockBox = document.getElementById('intermediate-lock');
      const content = document.getElementById('intermediate-content');
      
      if (lockBox && content) {
        lockBox.style.display = 'none';
        content.classList.remove('hidden');
        content.innerHTML = `
          <h2>🎉 Intermediate Lessons Unlocked!</h2>
          <p>Congratulations on completing all beginner lessons! You're ready for more challenging content.</p>
          <div style="background: var(--success-gradient); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
            <strong>Your Achievement:</strong> Completed ${enhancedLessons.length} lessons with required accuracy!
          </div>
        `;
      }
    }

    // Enhanced progress modal
    progressBtn.addEventListener('click', () => {
      updateProgressModal();
      progressModal.style.display = 'block';
    });

    function updateProgressModal() {
      const progressList = document.getElementById('progress-list');
      progressList.innerHTML = '';
      
      enhancedLessons.forEach(lesson => {
        const isCompleted = progressData.completedLessons.includes(lesson.id);
        const bestScore = progressData.bestScores[lesson.id];
        
        const listItem = document.createElement('div');
        listItem.style.cssText = `
          padding: 1rem;
          margin: 0.5rem 0;
          background: var(--bg-secondary);
          border-radius: 8px;
          border-left: 4px solid ${isCompleted ? '#4ade80' : '#6b7280'};
        `;
        
        listItem.innerHTML = `
          <div style="font-weight: 600;">${lesson.name}</div>
          <div style="color: var(--text-muted); font-size: 0.9rem;">${lesson.description}</div>
          ${bestScore ? 
            `<div style="margin-top: 0.5rem; font-size: 0.8rem; color: var(--text-secondary);">
              Best Score: ${bestScore.wpm} WPM, ${bestScore.accuracy}% accuracy
            </div>` : 
            '<div style="margin-top: 0.5rem; font-size: 0.8rem; color: #ef4444;">Not completed</div>'
          }
        `;
        
        progressList.appendChild(listItem);
      });
      
      // Update modal stats
      document.getElementById('progress-details').innerHTML = `
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin: 1rem 0;">
          <div style="text-align: center; padding: 1rem; background: var(--bg-secondary); border-radius: 8px;">
            <div style="font-size: 1.5rem; font-weight: 700;">${progressData.completedLessons.length}</div>
            <div style="font-size: 0.8rem; color: var(--text-muted);">Lessons Completed</div>
          </div>
          <div style="text-align: center; padding: 1rem; background: var(--bg-secondary); border-radius: 8px;">
            <div style="font-size: 1.5rem; font-weight: 700;">${Math.round(progressData.totalTime / 60)}</div>
            <div style="font-size: 0.8rem; color: var(--text-muted);">Minutes Practiced</div>
          </div>
          <div style="text-align: center; padding: 1rem; background: var(--bg-secondary); border-radius: 8px;">
            <div style="font-size: 1.5rem; font-weight: 700;">${progressData.streak}</div>
            <div style="font-size: 0.8rem; color: var(--text-muted);">Current Streak</div>
          </div>
        </div>
      `;
    }

    // Keyboard event listeners for physical keyboard
    document.addEventListener('keydown', (e) => {
      if (typingInput === document.activeElement) {
        highlightKey(e.code);
      }
    });

    // Initialize the application
    function initializeApp() {
      populateLessonsGrid();
      updateProgressDisplay();
      loadLesson(0); // Load first lesson by default
      
      // Check if intermediate should be unlocked
      if (progressData.completedLessons.length >= enhancedLessons.length) {
        unlockIntermediate();
      }
      
      // Add pulse animation to CSS
      const style = document.createElement('style');
      style.textContent = `
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.5; }
        }
        .completed {
          border: 2px solid #4ade80 !important;
          background: linear-gradient(135deg, rgba(74, 222, 128, 0.1), rgba(34, 197, 94, 0.1)) !important;
        }
        .locked {
          border: 2px solid #6b7280 !important;
          background: linear-gradient(135deg, rgba(107, 114, 128, 0.1), rgba(75, 85, 99, 0.1)) !important;
        }
        .category-indicator {
          position: absolute;
          top: 0.5rem;
          right: 0.5rem;
          width: 8px;
          height: 8px;
          border-radius: 50%;
        }
      `;
      document.head.appendChild(style);
    }

    // Start the application
    initializeApp();
    
    console.log('Professional Typing Lessons fully initialized!');
    console.log('Progress data:', progressData);
  </script>
</body>
</html>
